<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DailyOS - Smart Expense & Task Management</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --primary: #4361ee;
            --primary-light: #4895ef;
            --secondary: #3f37c9;
            --success: #4cc9f0;
            --danger: #f72585;
            --warning: #f8961e;
            --dark: #1a1a2e;
            --light: #f8f9fa;
            --gray: #6c757d;
            --card-bg: #ffffff;
            --sidebar-bg: #1e2a47;
            --sidebar-text: #e9ecef;
            --transition: all 0.3s ease;
            --shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            --radius: 12px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #e4e8f0 100%);
            color: var(--dark);
            min-height: 100vh;
            overflow-x: hidden;
        }

        .app-container {
            display: flex;
            min-height: 100vh;
        }

        /* Sidebar Styles */
        .sidebar {
            width: 260px;
            background: var(--sidebar-bg);
            color: var(--sidebar-text);
            padding: 1.5rem 1rem;
            transition: var(--transition);
            box-shadow: 2px 0 10px rgba(0, 0, 0, 0.1);
            z-index: 100;
        }

        .logo {
            display: flex;
            align-items: center;
            margin-bottom: 2rem;
            padding: 0 0.5rem;
        }

        .logo i {
            font-size: 1.8rem;
            color: var(--primary-light);
            margin-right: 0.75rem;
        }

        .logo h1 {
            font-size: 1.5rem;
            font-weight: 700;
            background: linear-gradient(to right, var(--primary-light), var(--success));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .nav-links {
            list-style: none;
        }

        .nav-links li {
            margin-bottom: 0.5rem;
        }

        .nav-links a {
            display: flex;
            align-items: center;
            padding: 0.85rem 1rem;
            color: var(--sidebar-text);
            text-decoration: none;
            border-radius: var(--radius);
            transition: var(--transition);
        }

        .nav-links a:hover, .nav-links a.active {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            transform: translateX(5px);
        }

        .nav-links i {
            margin-right: 0.75rem;
            font-size: 1.2rem;
            width: 24px;
            text-align: center;
        }

        /* Main Content Styles */
        .main-content {
            flex: 1;
            padding: 1.5rem;
            overflow-y: auto;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid rgba(0, 0, 0, 0.05);
        }

        .header-content {
            display: flex;
            flex-direction: column;
        }

        .header h2 {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--dark);
            margin-bottom: 0.25rem;
        }

        .user-greeting {
            font-size: 0.9rem;
            color: var(--gray);
            display: flex;
            align-items: center;
        }

        .user-badge {
            background: var(--primary);
            color: white;
            padding: 0.25rem 0.5rem;
            border-radius: 20px;
            font-size: 0.7rem;
            margin-left: 0.5rem;
            font-weight: 600;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .user-avatar {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 1.2rem;
            cursor: pointer;
        }

        /* View Styles */
        .view {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .view.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Card Styles */
        .card {
            background: var(--card-bg);
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            transition: var(--transition);
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.25rem;
        }

        .card-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--dark);
        }

        /* Dashboard Styles */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: var(--card-bg);
            border-radius: var(--radius);
            padding: 1.5rem;
            box-shadow: var(--shadow);
            display: flex;
            align-items: center;
            transition: var(--transition);
        }

        .stat-card:hover {
            transform: translateY(-5px);
        }

        .stat-icon {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 1rem;
            font-size: 1.5rem;
        }

        .income .stat-icon {
            background: rgba(76, 201, 240, 0.2);
            color: var(--success);
        }

        .expense .stat-icon {
            background: rgba(247, 37, 133, 0.2);
            color: var(--danger);
        }

        .budget .stat-icon {
            background: rgba(67, 97, 238, 0.2);
            color: var(--primary);
        }

        .net .stat-icon {
            background: rgba(248, 150, 30, 0.2);
            color: var(--warning);
        }

        .stat-info h3 {
            font-size: 0.9rem;
            color: var(--gray);
            margin-bottom: 0.5rem;
        }

        .stat-value {
            font-size: 1.5rem;
            font-weight: 700;
        }

        .dashboard-content {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 1.5rem;
        }

        .progress-bar {
            height: 10px;
            background: #e9ecef;
            border-radius: 5px;
            overflow: hidden;
            margin-top: 0.5rem;
        }

        .progress {
            height: 100%;
            border-radius: 5px;
            transition: width 0.5s ease;
        }

        .progress-success {
            background: var(--success);
        }

        .progress-warning {
            background: var(--warning);
        }

        .progress-danger {
            background: var(--danger);
        }

        /* Transaction & Task Styles */
        .transaction-item, .task-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem;
            border-bottom: 1px solid rgba(0, 0, 0, 0.05);
            transition: var(--transition);
        }

        .transaction-item:hover, .task-item:hover {
            background: rgba(0, 0, 0, 0.02);
            border-radius: 8px;
        }

        .transaction-details, .task-details {
            display: flex;
            align-items: center;
        }

        .transaction-icon, .task-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 1rem;
            font-size: 1rem;
        }

        .transaction-income .transaction-icon {
            background: rgba(76, 201, 240, 0.2);
            color: var(--success);
        }

        .transaction-expense .transaction-icon {
            background: rgba(247, 37, 133, 0.2);
            color: var(--danger);
        }

        .task-high .task-icon {
            background: rgba(247, 37, 133, 0.2);
            color: var(--danger);
        }

        .task-medium .task-icon {
            background: rgba(248, 150, 30, 0.2);
            color: var(--warning);
        }

        .task-low .task-icon {
            background: rgba(76, 201, 240, 0.2);
            color: var(--success);
        }

        .transaction-info h4, .task-info h4 {
            font-size: 1rem;
            margin-bottom: 0.25rem;
        }

        .transaction-info p, .task-info p {
            font-size: 0.85rem;
            color: var(--gray);
        }

        .transaction-amount, .task-actions {
            font-weight: 600;
        }

        .transaction-income .transaction-amount {
            color: var(--success);
        }

        .transaction-expense .transaction-amount {
            color: var(--danger);
        }

        .task-actions {
            display: flex;
            gap: 0.5rem;
        }

        .task-checkbox {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            border: 2px solid var(--gray);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
        }

        .task-checkbox.checked {
            background: var(--success);
            border-color: var(--success);
            color: white;
        }

        .task-completed {
            text-decoration: line-through;
            opacity: 0.7;
        }

        /* Button Styles */
        .btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: var(--radius);
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background: var(--secondary);
            transform: translateY(-2px);
        }

        .btn-success {
            background: var(--success);
            color: white;
        }

        .btn-danger {
            background: var(--danger);
            color: white;
        }

        .btn-outline {
            background: transparent;
            border: 1px solid var(--primary);
            color: var(--primary);
        }

        .btn-outline:hover {
            background: var(--primary);
            color: white;
        }

        .fab {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: var(--primary);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            box-shadow: 0 4px 20px rgba(67, 97, 238, 0.3);
            cursor: pointer;
            transition: var(--transition);
            z-index: 100;
        }

        .fab:hover {
            background: var(--secondary);
            transform: scale(1.1) rotate(90deg);
        }

        /* Modal Styles */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: var(--transition);
        }

        .modal.active {
            opacity: 1;
            visibility: visible;
        }

        .modal-content {
            background: white;
            border-radius: var(--radius);
            width: 90%;
            max-width: 500px;
            padding: 2rem;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            transform: translateY(-20px) scale(0.95);
            transition: var(--transition);
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal.active .modal-content {
            transform: translateY(0) scale(1);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .modal-title {
            font-size: 1.5rem;
            font-weight: 600;
        }

        .close-modal {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--gray);
        }

        .form-group {
            margin-bottom: 1.25rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
        }

        .form-control {
            width: 100%;
            padding: 0.75rem 1rem;
            border: 1px solid #ddd;
            border-radius: var(--radius);
            font-size: 1rem;
            transition: var(--transition);
        }

        .form-control:focus {
            border-color: var(--primary);
            outline: none;
            box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.2);
        }

        .form-tabs {
            display: flex;
            margin-bottom: 1.5rem;
            border-bottom: 1px solid #ddd;
        }

        .form-tab {
            padding: 0.75rem 1.5rem;
            background: none;
            border: none;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
            border-bottom: 3px solid transparent;
        }

        .form-tab.active {
            color: var(--primary);
            border-bottom-color: var(--primary);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Chart Styles */
        .chart-container {
            position: relative;
            height: 300px;
            margin-top: 1rem;
        }

        /* Settings Styles */
        .settings-section {
            margin-bottom: 2rem;
        }

        .settings-section h3 {
            font-size: 1.2rem;
            margin-bottom: 1rem;
            color: var(--dark);
            padding-bottom: 0.5rem;
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
        }

        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 24px;
            margin-right: 10px;
        }

        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 24px;
        }

        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 16px;
            width: 16px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }

        input:checked + .toggle-slider {
            background-color: var(--primary);
        }

        input:checked + .toggle-slider:before {
            transform: translateX(26px);
        }

        .toggle-label {
            display: flex;
            align-items: center;
            margin-bottom: 1rem;
        }

        .profile-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 2rem;
            margin: 0 auto 1.5rem;
        }

        /* Responsive Styles */
        @media (max-width: 1200px) {
            .dashboard-content {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 992px) {
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 768px) {
            .app-container {
                flex-direction: column;
            }
            
            .sidebar {
                width: 100%;
                padding: 1rem;
            }
            
            .nav-links {
                display: flex;
                overflow-x: auto;
                padding-bottom: 0.5rem;
            }
            
            .nav-links li {
                margin-bottom: 0;
                margin-right: 0.5rem;
            }
            
            .nav-links a {
                white-space: nowrap;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .header {
                flex-direction: column;
                align-items: flex-start;
                gap: 1rem;
            }
            
            .user-info {
                align-self: flex-end;
            }
            
            .header-content {
                width: 100%;
            }
        }

        @media (max-width: 576px) {
            .main-content {
                padding: 1rem;
            }
            
            .card {
                padding: 1rem;
            }
            
            .transaction-item, .task-item {
                flex-direction: column;
                align-items: flex-start;
                gap: 0.5rem;
            }
            
            .transaction-amount, .task-actions {
                align-self: flex-end;
            }
            
            .modal-content {
                padding: 1.5rem;
            }
        }

        /* Animation for task completion */
        @keyframes taskComplete {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        .task-complete-animation {
            animation: taskComplete 0.5s ease;
        }

        /* Loading animation */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Skeleton loader for AI insights */
        .skeleton-loader {
            background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
            background-size: 200% 100%;
            animation: loading 1.5s infinite;
            border-radius: 4px;
            height: 20px;
            margin-bottom: 10px;
        }

        @keyframes loading {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }

        /* Confirmation modal */
        .confirmation-modal .modal-content {
            max-width: 400px;
        }

        .confirmation-buttons {
            display: flex;
            gap: 1rem;
            margin-top: 1.5rem;
        }

        .confirmation-buttons .btn {
            flex: 1;
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- Sidebar Navigation -->
        <div class="sidebar">
            <div class="logo">
                <i class="fas fa-wallet"></i>
                <h1>DailyOS</h1>
            </div>
            <ul class="nav-links">
                <li><a href="#" class="nav-link active" data-view="dashboard"><i class="fas fa-home"></i> Dashboard</a></li>
                <li><a href="#" class="nav-link" data-view="transactions"><i class="fas fa-exchange-alt"></i> Transactions</a></li>
                <li><a href="#" class="nav-link" data-view="tasks"><i class="fas fa-tasks"></i> Tasks</a></li>
                <li><a href="#" class="nav-link" data-view="budget"><i class="fas fa-chart-pie"></i> Budget</a></li>
                <li><a href="#" class="nav-link" data-view="insights"><i class="fas fa-lightbulb"></i> Insights</a></li>
                <li><a href="#" class="nav-link" data-view="settings"><i class="fas fa-cog"></i> Settings</a></li>
            </ul>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <div class="header">
                <div class="header-content">
                    <h2 id="page-title">Dashboard</h2>
                    <div class="user-greeting">
                        Hi, <span id="user-name">John Doe</span>
                        <span class="user-badge" id="user-badge">Premium</span>
                    </div>
                </div>
                <div class="user-info">
                    <div class="user-avatar" id="user-avatar">
                        JD
                    </div>
                </div>
            </div>

            <!-- Dashboard View -->
            <div id="dashboard-view" class="view active">
                <div class="stats-grid">
                    <div class="stat-card income">
                        <div class="stat-icon">
                            <i class="fas fa-arrow-down"></i>
                        </div>
                        <div class="stat-info">
                            <h3>Total Income</h3>
                            <div class="stat-value">₹25,400</div>
                        </div>
                    </div>
                    <div class="stat-card expense">
                        <div class="stat-icon">
                            <i class="fas fa-arrow-up"></i>
                        </div>
                        <div class="stat-info">
                            <h3>Total Expense</h3>
                            <div class="stat-value">₹18,750</div>
                        </div>
                    </div>
                    <div class="stat-card budget">
                        <div class="stat-icon">
                            <i class="fas fa-wallet"></i>
                        </div>
                        <div class="stat-info">
                            <h3>Monthly Budget</h3>
                            <div class="stat-value">₹20,000</div>
                        </div>
                    </div>
                    <div class="stat-card net">
                        <div class="stat-icon">
                            <i class="fas fa-chart-line"></i>
                        </div>
                        <div class="stat-info">
                            <h3>Net Worth</h3>
                            <div class="stat-value">₹6,650</div>
                        </div>
                    </div>
                </div>

                <div class="dashboard-content">
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">Recent Transactions</div>
                            <button class="btn btn-outline">View All</button>
                        </div>
                        <div id="recent-transactions">
                            <!-- Transactions will be loaded here -->
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">High Priority Tasks</div>
                            <button class="btn btn-outline">View All</button>
                        </div>
                        <div id="high-priority-tasks">
                            <!-- Tasks will be loaded here -->
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <div class="card-title">Budget Status</div>
                    </div>
                    <div class="budget-status">
                        <div class="budget-item">
                            <div class="budget-info">
                                <span>Monthly Budget</span>
                                <span>₹20,000</span>
                            </div>
                            <div class="progress-bar">
                                <div class="progress progress-warning" style="width: 75%"></div>
                            </div>
                            <div class="budget-details">
                                <span>Spent: ₹15,000</span>
                                <span>Remaining: ₹5,000</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Transactions View -->
            <div id="transactions-view" class="view">
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">All Transactions</div>
                        <button class="btn btn-primary" id="add-transaction-btn">Add Transaction</button>
                    </div>
                    <div id="transactions-list">
                        <!-- Transactions will be loaded here -->
                    </div>
                </div>
            </div>

            <!-- Tasks View -->
            <div id="tasks-view" class="view">
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">Task Manager</div>
                        <button class="btn btn-primary" id="add-task-btn">Add Task</button>
                    </div>
                    <div id="tasks-list">
                        <!-- Tasks will be loaded here -->
                    </div>
                </div>
            </div>

            <!-- Budget View -->
            <div id="budget-view" class="view">
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">Budget Overview</div>
                    </div>
                    <div class="chart-container">
                        <canvas id="budget-chart"></canvas>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <div class="card-title">Set Monthly Budget</div>
                    </div>
                    <div class="budget-form">
                        <div class="form-group">
                            <label for="monthly-budget">Monthly Budget (₹)</label>
                            <input type="number" id="monthly-budget" class="form-control" placeholder="Enter your monthly budget">
                        </div>
                        <button class="btn btn-primary" id="update-budget">Update Budget</button>
                    </div>
                </div>
            </div>

            <!-- Insights View -->
            <div id="insights-view" class="view">
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">Spending Analysis</div>
                    </div>
                    <div class="chart-container">
                        <canvas id="spending-chart"></canvas>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <div class="card-title">AI Insights</div>
                    </div>
                    <div class="insights-content">
                        <p>Get personalized financial advice based on your spending patterns.</p>
                        <button class="btn btn-primary" id="generate-insights">
                            <i class="fas fa-robot"></i> Generate Insights
                        </button>
                        <div id="ai-insights" class="mt-3">
                            <!-- AI insights will appear here -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Settings View -->
            <div id="settings-view" class="view">
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">Profile Settings</div>
                    </div>
                    <div class="settings-content">
                        <div class="settings-section">
                            <h3>Personal Information</h3>
                            <div class="profile-avatar" id="profile-avatar">
                                JD
                            </div>
                            <div class="form-group">
                                <label for="profile-name">Full Name</label>
                                <input type="text" id="profile-name" class="form-control" placeholder="Enter your full name">
                            </div>
                            <div class="form-group">
                                <label for="profile-email">Email Address</label>
                                <input type="email" id="profile-email" class="form-control" placeholder="Enter your email">
                            </div>
                            <div class="form-group">
                                <label for="profile-phone">Phone Number</label>
                                <input type="tel" id="profile-phone" class="form-control" placeholder="Enter your phone number">
                            </div>
                            <div class="form-group">
                                <label for="profile-badge">User Badge</label>
                                <select id="profile-badge" class="form-control">
                                    <option value="Free">Free User</option>
                                    <option value="Premium">Premium</option>
                                    <option value="Pro">Pro</option>
                                    <option value="VIP">VIP</option>
                                </select>
                            </div>
                            <button class="btn btn-primary" id="save-profile">Save Profile</button>
                        </div>

                        <div class="settings-section">
                            <h3>Notification Settings</h3>
                            <div class="toggle-label">
                                <label class="toggle-switch">
                                    <input type="checkbox" id="notifications-budget" checked>
                                    <span class="toggle-slider"></span>
                                </label>
                                <span>Budget Limit Notifications</span>
                            </div>
                            <div class="toggle-label">
                                <label class="toggle-switch">
                                    <input type="checkbox" id="notifications-task" checked>
                                    <span class="toggle-slider"></span>
                                </label>
                                <span>Task Reminders</span>
                            </div>
                            <div class="toggle-label">
                                <label class="toggle-switch">
                                    <input type="checkbox" id="notifications-insight">
                                    <span class="toggle-slider"></span>
                                </label>
                                <span>Weekly Financial Insights</span>
                            </div>
                            <div class="toggle-label">
                                <label class="toggle-switch">
                                    <input type="checkbox" id="notifications-promo">
                                    <span class="toggle-slider"></span>
                                </label>
                                <span>Promotional Emails</span>
                            </div>
                        </div>

                        <div class="settings-section">
                            <h3>Budget Reminder Settings</h3>
                            <div class="form-group">
                                <label for="budget-reminder-threshold">Budget Alert Threshold (%)</label>
                                <input type="number" id="budget-reminder-threshold" class="form-control" min="0" max="100" value="80">
                                <small>Get notified when you've spent this percentage of your budget</small>
                            </div>
                            <div class="form-group">
                                <label for="budget-reminder-frequency">Reminder Frequency</label>
                                <select id="budget-reminder-frequency" class="form-control">
                                    <option value="daily">Daily</option>
                                    <option value="weekly" selected>Weekly</option>
                                    <option value="monthly">Monthly</option>
                                </select>
                            </div>
                            <button class="btn btn-primary" id="save-reminder-settings">Save Reminder Settings</button>
                        </div>

                        <div class="settings-section">
                            <h3>Application Settings</h3>
                            <div class="form-group">
                                <label for="currency">Currency</label>
                                <select id="currency" class="form-control">
                                    <option value="INR" selected>Indian Rupee (₹)</option>
                                    <option value="USD">US Dollar ($)</option>
                                    <option value="EUR">Euro (€)</option>
                                    <option value="GBP">British Pound (£)</option>
                                </select>
                            </div>
                            <div class="toggle-label">
                                <label class="toggle-switch">
                                    <input type="checkbox" id="notifications" checked>
                                    <span class="toggle-slider"></span>
                                </label>
                                <span>Enable Notifications</span>
                            </div>
                            <button class="btn btn-danger" id="clear-data">Clear All Data</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Floating Action Button -->
    <div class="fab" id="fab">
        <i class="fas fa-plus"></i>
    </div>

    <!-- Add Entry Modal -->
    <div class="modal" id="add-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Add New Entry</h3>
                <button class="close-modal">&times;</button>
            </div>
            <div class="form-tabs">
                <button class="form-tab active" data-tab="transaction">Transaction</button>
                <button class="form-tab" data-tab="task">Task</button>
            </div>

            <div id="transaction-form" class="tab-content active">
                <div class="form-group">
                    <label for="transaction-type">Type</label>
                    <select id="transaction-type" class="form-control">
                        <option value="expense">Expense</option>
                        <option value="income">Income</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="transaction-amount">Amount (₹)</label>
                    <input type="number" id="transaction-amount" class="form-control" placeholder="Enter amount">
                </div>
                <div class="form-group">
                    <label for="transaction-category">Category</label>
                    <select id="transaction-category" class="form-control">
                        <option value="food">Food</option>
                        <option value="transport">Transport</option>
                        <option value="bills">Bills</option>
                        <option value="shopping">Shopping</option>
                        <option value="entertainment">Entertainment</option>
                        <option value="other">Other</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="transaction-date">Date</label>
                    <input type="date" id="transaction-date" class="form-control">
                </div>
                <div class="form-group">
                    <label for="transaction-note">Note (Optional)</label>
                    <input type="text" id="transaction-note" class="form-control" placeholder="Add a note">
                </div>
                <button class="btn btn-primary" id="save-transaction">Save Transaction</button>
            </div>

            <div id="task-form" class="tab-content">
                <div class="form-group">
                    <label for="task-title">Task Title</label>
                    <input type="text" id="task-title" class="form-control" placeholder="What needs to be done?">
                </div>
                <div class="form-group">
                    <label for="task-due-date">Due Date</label>
                    <input type="date" id="task-due-date" class="form-control">
                </div>
                <div class="form-group">
                    <label for="task-priority">Priority</label>
                    <select id="task-priority" class="form-control">
                        <option value="low">Low</option>
                        <option value="medium">Medium</option>
                        <option value="high">High</option>
                    </select>
                </div>
                <button class="btn btn-primary" id="save-task">Save Task</button>
            </div>
        </div>
    </div>

    <!-- Confirmation Modal -->
    <div class="modal confirmation-modal" id="confirmation-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="confirmation-title">Confirm Action</h3>
                <button class="close-modal">&times;</button>
            </div>
            <p id="confirmation-message">Are you sure you want to perform this action?</p>
            <div class="confirmation-buttons">
                <button class="btn btn-outline" id="cancel-confirmation">Cancel</button>
                <button class="btn btn-danger" id="confirm-action">Confirm</button>
            </div>
        </div>
    </div>

    <!-- Alert Modal -->
    <div class="modal" id="alert-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="alert-title">Alert</h3>
                <button class="close-modal">&times;</button>
            </div>
            <p id="alert-message">This is an alert message.</p>
            <div class="confirmation-buttons">
                <button class="btn btn-primary" id="close-alert">OK</button>
            </div>
        </div>
    </div>

    <script>
        // Application State
        const appState = {
            currentView: 'dashboard',
            transactions: [],
            tasks: [],
            settings: {
                monthlyBudget: 20000,
                currency: 'INR',
                notifications: true,
                profile: {
                    name: 'John Doe',
                    email: 'john.doe@example.com',
                    phone: '+91 98765 43210',
                    badge: 'Premium'
                },
                notificationsSettings: {
                    budget: true,
                    task: true,
                    insight: false,
                    promo: false
                },
                budgetReminder: {
                    threshold: 80,
                    frequency: 'weekly'
                }
            },
            loadingAi: false
        };

        // Default data for initial experience
        const defaultTransactions = [
            { id: 1, type: 'expense', amount: 450, category: 'food', date: '2023-06-15', note: 'Lunch with friends' },
            { id: 2, type: 'income', amount: 15000, category: 'salary', date: '2023-06-10', note: 'Monthly salary' },
            { id: 3, type: 'expense', amount: 1200, category: 'bills', date: '2023-06-05', note: 'Electricity bill' },
            { id: 4, type: 'expense', amount: 300, category: 'transport', date: '2023-06-03', note: 'Fuel' },
            { id: 5, type: 'expense', amount: 2500, category: 'shopping', date: '2023-05-28', note: 'New headphones' },
            { id: 6, type: 'income', amount: 5000, category: 'freelance', date: '2023-05-25', note: 'Freelance project' },
            { id: 7, type: 'expense', amount: 800, category: 'entertainment', date: '2023-05-20', note: 'Movie tickets' }
        ];

        const defaultTasks = [
            { id: 1, title: 'Pay electricity bill', dueDate: '2023-06-20', priority: 'high', completed: false },
            { id: 2, title: 'Finish project report', dueDate: '2023-06-18', priority: 'medium', completed: false },
            { id: 3, title: 'Grocery shopping', dueDate: '2023-06-12', priority: 'low', completed: true },
            { id: 4, title: 'Book flight tickets', dueDate: '2023-06-25', priority: 'medium', completed: false },
            { id: 5, title: 'Dentist appointment', dueDate: '2023-06-15', priority: 'high', completed: false },
            { id: 6, title: 'Renew gym membership', dueDate: '2023-06-30', priority: 'low', completed: false }
        ];

        // Storage keys
        const STORAGE_KEYS = {
            TRANSACTIONS: 'dailyOS_transactions',
            TASKS: 'dailyOS_tasks',
            SETTINGS: 'dailyOS_settings'
        };

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            // Load data from localStorage or use defaults
            loadData();
            
            // Initialize UI
            initializeNavigation();
            initializeModals();
            initializeEventListeners();
            
            // Render the initial view
            renderApp();
            
            // Update header with profile info
            updateHeaderProfile();
        });

        // Data Management Functions
        function loadData() {
            // Load transactions
            const storedTransactions = localStorage.getItem(STORAGE_KEYS.TRANSACTIONS);
            appState.transactions = storedTransactions ? JSON.parse(storedTransactions) : defaultTransactions;
            
            // Load tasks
            const storedTasks = localStorage.getItem(STORAGE_KEYS.TASKS);
            appState.tasks = storedTasks ? JSON.parse(storedTasks) : defaultTasks;
            
            // Load settings
            const storedSettings = localStorage.getItem(STORAGE_KEYS.SETTINGS);
            if (storedSettings) {
                const parsedSettings = JSON.parse(storedSettings);
                appState.settings = { ...appState.settings, ...parsedSettings };
                
                // Ensure nested objects are properly merged
                if (parsedSettings.profile) {
                    appState.settings.profile = { ...appState.settings.profile, ...parsedSettings.profile };
                }
                if (parsedSettings.notificationsSettings) {
                    appState.settings.notificationsSettings = { ...appState.settings.notificationsSettings, ...parsedSettings.notificationsSettings };
                }
                if (parsedSettings.budgetReminder) {
                    appState.settings.budgetReminder = { ...appState.settings.budgetReminder, ...parsedSettings.budgetReminder };
                }
            }
        }

        function saveData() {
            localStorage.setItem(STORAGE_KEYS.TRANSACTIONS, JSON.stringify(appState.transactions));
            localStorage.setItem(STORAGE_KEYS.TASKS, JSON.stringify(appState.tasks));
            localStorage.setItem(STORAGE_KEYS.SETTINGS, JSON.stringify(appState.settings));
        }

        // Navigation Functions
        function initializeNavigation() {
            const navLinks = document.querySelectorAll('.nav-link');
            
            navLinks.forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    const viewId = this.getAttribute('data-view');
                    changeView(viewId);
                });
            });
        }

        function changeView(viewId) {
            appState.currentView = viewId;
            renderApp();
        }

        // Modal Functions
        function initializeModals() {
            // Add Entry Modal
            const modal = document.getElementById('add-modal');
            const fab = document.getElementById('fab');
            const closeModal = document.querySelectorAll('.close-modal');
            const formTabs = document.querySelectorAll('.form-tab');
            const tabContents = document.querySelectorAll('.tab-content');

            fab.addEventListener('click', function() {
                modal.classList.add('active');
            });

            closeModal.forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('.modal').forEach(modal => {
                        modal.classList.remove('active');
                    });
                });
            });

            formTabs.forEach(tab => {
                tab.addEventListener('click', function() {
                    const tabId = this.getAttribute('data-tab');
                    
                    formTabs.forEach(t => t.classList.remove('active'));
                    this.classList.add('active');
                    
                    tabContents.forEach(content => {
                        content.classList.remove('active');
                        if (content.id === `${tabId}-form`) {
                            content.classList.add('active');
                        }
                    });
                });
            });

            // Close modal when clicking outside
            window.addEventListener('click', function(e) {
                if (e.target.classList.contains('modal')) {
                    document.querySelectorAll('.modal').forEach(modal => {
                        modal.classList.remove('active');
                    });
                }
            });
        }

        function showConfirmation(title, message, confirmCallback) {
            document.getElementById('confirmation-title').textContent = title;
            document.getElementById('confirmation-message').textContent = message;
            
            const confirmBtn = document.getElementById('confirm-action');
            const cancelBtn = document.getElementById('cancel-confirmation');
            
            // Remove previous event listeners
            const newConfirmBtn = confirmBtn.cloneNode(true);
            const newCancelBtn = cancelBtn.cloneNode(true);
            
            confirmBtn.parentNode.replaceChild(newConfirmBtn, confirmBtn);
            cancelBtn.parentNode.replaceChild(newCancelBtn, cancelBtn);
            
            // Add new event listeners
            newConfirmBtn.addEventListener('click', function() {
                document.getElementById('confirmation-modal').classList.remove('active');
                confirmCallback();
            });
            
            newCancelBtn.addEventListener('click', function() {
                document.getElementById('confirmation-modal').classList.remove('active');
            });
            
            document.getElementById('confirmation-modal').classList.add('active');
        }

        function alertMessage(title, message, type = 'info') {
            document.getElementById('alert-title').textContent = title;
            document.getElementById('alert-message').textContent = message;
            
            const alertBtn = document.getElementById('close-alert');
            alertBtn.className = `btn ${type === 'success' ? 'btn-success' : type === 'danger' ? 'btn-danger' : 'btn-primary'}`;
            
            document.getElementById('alert-modal').classList.add('active');
        }

        // Event Listeners
        function initializeEventListeners() {
            // Add transaction
            document.getElementById('save-transaction').addEventListener('click', function() {
                const type = document.getElementById('transaction-type').value;
                const amount = parseFloat(document.getElementById('transaction-amount').value);
                const category = document.getElementById('transaction-category').value;
                const date = document.getElementById('transaction-date').value;
                const note = document.getElementById('transaction-note').value;
                
                if (amount && date) {
                    const newTransaction = {
                        id: Date.now(),
                        type,
                        amount,
                        category,
                        date,
                        note
                    };
                    
                    appState.transactions.push(newTransaction);
                    saveData();
                    renderApp();
                    
                    document.getElementById('add-modal').classList.remove('active');
                    document.getElementById('transaction-form').reset();
                    
                    alertMessage('Success', 'Transaction added successfully!', 'success');
                } else {
                    alertMessage('Error', 'Please fill in all required fields', 'danger');
                }
            });

            // Add task
            document.getElementById('save-task').addEventListener('click', function() {
                const title = document.getElementById('task-title').value;
                const dueDate = document.getElementById('task-due-date').value;
                const priority = document.getElementById('task-priority').value;
                
                if (title && dueDate) {
                    const newTask = {
                        id: Date.now(),
                        title,
                        dueDate,
                        priority,
                        completed: false
                    };
                    
                    appState.tasks.push(newTask);
                    saveData();
                    renderApp();
                    
                    document.getElementById('add-modal').classList.remove('active');
                    document.getElementById('task-form').reset();
                    
                    alertMessage('Success', 'Task added successfully!', 'success');
                } else {
                    alertMessage('Error', 'Please fill in all required fields', 'danger');
                }
            });

            // Update budget
            document.getElementById('update-budget').addEventListener('click', function() {
                const budgetInput = document.getElementById('monthly-budget');
                const budgetValue = parseFloat(budgetInput.value);
                
                if (budgetValue && budgetValue > 0) {
                    appState.settings.monthlyBudget = budgetValue;
                    saveData();
                    renderApp();
                    
                    budgetInput.value = '';
                    alertMessage('Success', 'Budget updated successfully!', 'success');
                } else {
                    alertMessage('Error', 'Please enter a valid budget amount', 'danger');
                }
            });

            // Generate AI insights
            document.getElementById('generate-insights').addEventListener('click', function() {
                generateSmartInsight();
            });

            // Save profile
            document.getElementById('save-profile').addEventListener('click', function() {
                const name = document.getElementById('profile-name').value;
                const email = document.getElementById('profile-email').value;
                const phone = document.getElementById('profile-phone').value;
                const badge = document.getElementById('profile-badge').value;
                
                if (name) {
                    appState.settings.profile.name = name;
                    appState.settings.profile.email = email;
                    appState.settings.profile.phone = phone;
                    appState.settings.profile.badge = badge;
                    
                    saveData();
                    updateHeaderProfile();
                    
                    alertMessage('Success', 'Profile updated successfully!', 'success');
                } else {
                    alertMessage('Error', 'Please enter your name', 'danger');
                }
            });

            // Save reminder settings
            document.getElementById('save-reminder-settings').addEventListener('click', function() {
                const threshold = parseInt(document.getElementById('budget-reminder-threshold').value);
                const frequency = document.getElementById('budget-reminder-frequency').value;
                
                if (threshold >= 0 && threshold <= 100) {
                    appState.settings.budgetReminder.threshold = threshold;
                    appState.settings.budgetReminder.frequency = frequency;
                    
                    saveData();
                    
                    alertMessage('Success', 'Reminder settings updated successfully!', 'success');
                } else {
                    alertMessage('Error', 'Please enter a valid threshold (0-100)', 'danger');
                }
            });

            // Clear all data
            document.getElementById('clear-data').addEventListener('click', function() {
                showConfirmation(
                    'Clear All Data',
                    'Are you sure you want to clear all data? This action cannot be undone.',
                    function() {
                        localStorage.clear();
                        loadData();
                        renderApp();
                        updateHeaderProfile();
                        alertMessage('Success', 'All data has been cleared.', 'success');
                    }
                );
            });

            // Close alert
            document.getElementById('close-alert').addEventListener('click', function() {
                document.getElementById('alert-modal').classList.remove('active');
            });

            // Notification toggles
            document.getElementById('notifications-budget').addEventListener('change', function() {
                appState.settings.notificationsSettings.budget = this.checked;
                saveData();
            });

            document.getElementById('notifications-task').addEventListener('change', function() {
                appState.settings.notificationsSettings.task = this.checked;
                saveData();
            });

            document.getElementById('notifications-insight').addEventListener('change', function() {
                appState.settings.notificationsSettings.insight = this.checked;
                saveData();
            });

            document.getElementById('notifications-promo').addEventListener('change', function() {
                appState.settings.notificationsSettings.promo = this.checked;
                saveData();
            });

            document.getElementById('notifications').addEventListener('change', function() {
                appState.settings.notifications = this.checked;
                saveData();
            });

            document.getElementById('currency').addEventListener('change', function() {
                appState.settings.currency = this.value;
                saveData();
            });
        }

        // Profile Functions
        function updateHeaderProfile() {
            const profile = appState.settings.profile;
            
            // Update header
            document.getElementById('user-name').textContent = profile.name;
            document.getElementById('user-badge').textContent = profile.badge;
            
            // Update avatar with initials
            const initials = profile.name.split(' ').map(n => n[0]).join('').toUpperCase();
            document.getElementById('user-avatar').textContent = initials;
            document.getElementById('profile-avatar').textContent = initials;
            
            // Update settings form
            document.getElementById('profile-name').value = profile.name;
            document.getElementById('profile-email').value = profile.email;
            document.getElementById('profile-phone').value = profile.phone;
            document.getElementById('profile-badge').value = profile.badge;
            
            // Update notification toggles
            document.getElementById('notifications-budget').checked = appState.settings.notificationsSettings.budget;
            document.getElementById('notifications-task').checked = appState.settings.notificationsSettings.task;
            document.getElementById('notifications-insight').checked = appState.settings.notificationsSettings.insight;
            document.getElementById('notifications-promo').checked = appState.settings.notificationsSettings.promo;
            document.getElementById('notifications').checked = appState.settings.notifications;
            
            // Update reminder settings
            document.getElementById('budget-reminder-threshold').value = appState.settings.budgetReminder.threshold;
            document.getElementById('budget-reminder-frequency').value = appState.settings.budgetReminder.frequency;
            
            // Update currency
            document.getElementById('currency').value = appState.settings.currency;
        }

        // Financial Calculations
        function calculateFinancials() {
            const now = new Date();
            const currentMonth = now.getMonth();
            const currentYear = now.getFullYear();
            
            let totalIncome = 0;
            let totalExpense = 0;
            let currentMonthIncome = 0;
            let currentMonthExpense = 0;
            const categoryExpenses = {};
            
            appState.transactions.forEach(transaction => {
                const transactionDate = new Date(transaction.date);
                const isCurrentMonth = transactionDate.getMonth() === currentMonth && 
                                      transactionDate.getFullYear() === currentYear;
                
                if (transaction.type === 'income') {
                    totalIncome += transaction.amount;
                    if (isCurrentMonth) currentMonthIncome += transaction.amount;
                } else {
                    totalExpense += transaction.amount;
                    if (isCurrentMonth) currentMonthExpense += transaction.amount;
                    
                    // Track category expenses
                    if (!categoryExpenses[transaction.category]) {
                        categoryExpenses[transaction.category] = 0;
                    }
                    categoryExpenses[transaction.category] += transaction.amount;
                }
            });
            
            const netWorth = totalIncome - totalExpense;
            const netThisMonth = currentMonthIncome - currentMonthExpense;
            const budgetRemaining = appState.settings.monthlyBudget - currentMonthExpense;
            const budgetPercentage = (currentMonthExpense / appState.settings.monthlyBudget) * 100;
            
            return {
                totalIncome,
                totalExpense,
                netWorth,
                currentMonthIncome,
                currentMonthExpense,
                netThisMonth,
                budgetRemaining,
                budgetPercentage,
                categoryExpenses
            };
        }

        // AI Insights
        async function generateSmartInsight() {
            if (appState.loadingAi) return;
            
            appState.loadingAi = true;
            const button = document.getElementById('generate-insights');
            const originalContent = button.innerHTML;
            
            button.innerHTML = '<div class="loading"></div> Analyzing...';
            button.disabled = true;
            
            const insightsContainer = document.getElementById('ai-insights');
            insightsContainer.innerHTML = `
                <div class="skeleton-loader"></div>
                <div class="skeleton-loader" style="width: 80%"></div>
                <div class="skeleton-loader" style="width: 60%"></div>
            `;
            
            try {
                const financials = calculateFinancials();
                const recentTransactions = appState.transactions
                    .filter(t => {
                        const transactionDate = new Date(t.date);
                        const ninetyDaysAgo = new Date();
                        ninetyDaysAgo.setDate(ninetyDaysAgo.getDate() - 90);
                        return transactionDate >= ninetyDaysAgo;
                    })
                    .slice(-10); // Last 10 transactions
                
                // Prepare prompt for Gemini API
                const prompt = `You are 'DailyOS', a friendly and professional personal finance coach. Your tone is encouraging, clear, and actionable. You are analyzing a user's spending data to help them improve their financial health.

Here is my financial data:
My set monthly budget is: ₹${appState.settings.monthlyBudget}
I have already spent ₹${financials.currentMonthExpense} this month.

Here is a list of my recent transactions: ${JSON.stringify(recentTransactions)}

Please analyze this and provide a brief, easy-to-read response in the following format:

1. Financial Habit: (Identify my top spending category and a key spending habit, e.g., 'frequent small purchases on food'.)

2. Spending Prediction: (Based on my current spending rate, project my total spending by the end of this month. Tell me if I'm on track to meet my budget.)

3. Actionable Advice: (Give me one specific, simple tip I can use today to save money or improve my habits.)`;
                
                // In a real implementation, you would call the Gemini API here
                // For this demo, we'll simulate a response after a delay
                const response = await fetchWithRetry(prompt);
                
                // Display the response
                displayAIResponse(response);
                
            } catch (error) {
                console.error('Error generating insight:', error);
                insightsContainer.innerHTML = `
                    <div class="p-4 text-center">
                        <i class="fas fa-exclamation-circle" style="color: var(--danger); font-size: 2rem; margin-bottom: 1rem;"></i>
                        <p style="color: var(--danger);">Sorry, we couldn't generate insights right now. Please try again later.</p>
                    </div>
                `;
            } finally {
                button.innerHTML = originalContent;
                button.disabled = false;
                appState.loadingAi = false;
            }
        }

        // Simulated API call with retry logic
        async function fetchWithRetry(prompt, maxRetries = 3) {
            for (let i = 0; i < maxRetries; i++) {
                try {
                    // Simulate API delay
                    await new Promise(resolve => setTimeout(resolve, 1500 + i * 500));
                    
                    // Simulated responses
                    const responses = [
                        `1. Financial Habit: Your top spending category is Food, with frequent small purchases that add up throughout the week.

2. Spending Prediction: Based on your current spending rate, you're projected to spend approximately ₹${Math.round(calculateFinancials().currentMonthExpense * 1.2)} by month's end. You're getting close to your budget limit with about 25% remaining.

3. Actionable Advice: Try meal prepping on weekends to reduce daily food expenses. Planning just 3-4 meals in advance could save you 20-30% on food costs this month.`,

                        `1. Financial Habit: You have consistent spending on Bills and Shopping, with occasional larger purchases that impact your budget.

2. Spending Prediction: At your current rate, you'll spend about ₹${Math.round(calculateFinancials().currentMonthExpense * 1.15)} this month. You're comfortably within your budget with plenty remaining.

3. Actionable Advice: Consider setting up separate savings categories for larger purchases to avoid impacting your essential expenses.`,

                        `1. Financial Habit: Your entertainment expenses have increased by 15% compared to last month, while transport costs remain stable.

2. Spending Prediction: You're on track to spend ₹${Math.round(calculateFinancials().currentMonthExpense * 1.1)} this month, well within your budget limits.

3. Actionable Advice: Review your subscription services - you might be paying for services you no longer use. Canceling just one could save you money monthly.`
                    ];
                    
                    // Return a random response for demo purposes
                    return responses[Math.floor(Math.random() * responses.length)];
                    
                } catch (error) {
                    if (i === maxRetries - 1) throw error;
                    // Wait longer between retries
                    await new Promise(resolve => setTimeout(resolve, 1000 * (i + 1)));
                }
            }
        }

        function displayAIResponse(response) {
            const insightsContainer = document.getElementById('ai-insights');
            
            // Parse the response and format it
            const lines = response.split('\n').filter(line => line.trim());
            
            let html = '';
            lines.forEach(line => {
                if (line.includes('Financial Habit:')) {
                    html += `<h4 style="color: var(--primary); font-weight: 600; margin-bottom: 0.5rem;">Financial Habit</h4><p style="margin-bottom: 1rem;">${line.replace('1. Financial Habit:', '').trim()}</p>`;
                } else if (line.includes('Spending Prediction:')) {
                    html += `<h4 style="color: var(--primary); font-weight: 600; margin-bottom: 0.5rem;">Spending Prediction</h4><p style="margin-bottom: 1rem;">${line.replace('2. Spending Prediction:', '').trim()}</p>`;
                } else if (line.includes('Actionable Advice:')) {
                    html += `<h4 style="color: var(--primary); font-weight: 600; margin-bottom: 0.5rem;">Actionable Advice</h4><p style="margin-bottom: 0;">${line.replace('3. Actionable Advice:', '').trim()}</p>`;
                } else if (line.match(/^\d\./)) {
                    // Skip numbered lines that don't match our format
                } else {
                    html += `<p style="margin-bottom: 1rem;">${line.trim()}</p>`;
                }
            });
            
            insightsContainer.innerHTML = html;
        }

        // Rendering Functions
        function renderApp() {
            // Update active navigation
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('active');
                if (link.getAttribute('data-view') === appState.currentView) {
                    link.classList.add('active');
                }
            });
            
            // Update page title
            document.getElementById('page-title').textContent = 
                document.querySelector(`.nav-link[data-view="${appState.currentView}"]`).textContent.trim();
            
            // Hide all views
            document.querySelectorAll('.view').forEach(view => {
                view.classList.remove('active');
            });
            
            // Show active view
            document.getElementById(`${appState.currentView}-view`).classList.add('active');
            
            // Render view-specific content
            switch(appState.currentView) {
                case 'dashboard':
                    renderDashboard();
                    break;
                case 'transactions':
                    renderTransactionManager();
                    break;
                case 'tasks':
                    renderTaskManager();
                    break;
                case 'budget':
                    renderBudgetManager();
                    break;
                case 'insights':
                    renderInsights();
                    break;
                case 'settings':
                    renderSettings();
                    break;
            }
        }

        function renderDashboard() {
            const financials = calculateFinancials();
            
            // Update stat cards
            document.querySelector('.income .stat-value').textContent = `₹${financials.totalIncome.toLocaleString()}`;
            document.querySelector('.expense .stat-value').textContent = `₹${financials.totalExpense.toLocaleString()}`;
            document.querySelector('.budget .stat-value').textContent = `₹${appState.settings.monthlyBudget.toLocaleString()}`;
            document.querySelector('.net .stat-value').textContent = `₹${financials.netWorth.toLocaleString()}`;
            
            // Update budget status
            const progressBar = document.querySelector('.progress');
            progressBar.style.width = `${Math.min(financials.budgetPercentage, 100)}%`;
            
            // Color code the progress bar
            if (financials.budgetPercentage > 100) {
                progressBar.className = 'progress progress-danger';
            } else if (financials.budgetPercentage > 80) {
                progressBar.className = 'progress progress-warning';
            } else {
                progressBar.className = 'progress progress-success';
            }
            
            document.querySelector('.budget-details').innerHTML = `
                <span>Spent: ₹${financials.currentMonthExpense.toLocaleString()}</span>
                <span>Remaining: ₹${Math.max(0, financials.budgetRemaining).toLocaleString()}</span>
            `;
            
            // Render recent transactions
            const recentTransactionsContainer = document.getElementById('recent-transactions');
            recentTransactionsContainer.innerHTML = '';
            
            const recentTransactions = [...appState.transactions]
                .sort((a, b) => new Date(b.date) - new Date(a.date))
                .slice(0, 5);
            
            recentTransactions.forEach(transaction => {
                recentTransactionsContainer.appendChild(createTransactionElement(transaction));
            });
            
            // Render high priority tasks
            const highPriorityTasksContainer = document.getElementById('high-priority-tasks');
            highPriorityTasksContainer.innerHTML = '';
            
            const highPriorityTasks = appState.tasks
                .filter(task => !task.completed && task.priority === 'high')
                .sort((a, b) => new Date(a.dueDate) - new Date(b.dueDate))
                .slice(0, 3);
            
            if (highPriorityTasks.length === 0) {
                highPriorityTasksContainer.innerHTML = '<p style="text-align: center; color: var(--gray); padding: 1rem;">No high priority tasks</p>';
            } else {
                highPriorityTasks.forEach(task => {
                    highPriorityTasksContainer.appendChild(createTaskElement(task));
                });
            }
        }

        function renderTransactionManager() {
            const transactionsContainer = document.getElementById('transactions-list');
            transactionsContainer.innerHTML = '';
            
            const sortedTransactions = [...appState.transactions]
                .sort((a, b) => new Date(b.date) - new Date(a.date));
            
            if (sortedTransactions.length === 0) {
                transactionsContainer.innerHTML = '<p style="text-align: center; color: var(--gray); padding: 2rem;">No transactions yet</p>';
            } else {
                sortedTransactions.forEach(transaction => {
                    transactionsContainer.appendChild(createTransactionElement(transaction, true));
                });
            }
        }

        function renderTaskManager() {
            const tasksContainer = document.getElementById('tasks-list');
            tasksContainer.innerHTML = '';
            
            // Sort tasks: incomplete first, then by priority
            const sortedTasks = [...appState.tasks].sort((a, b) => {
                if (a.completed !== b.completed) {
                    return a.completed ? 1 : -1;
                }
                
                const priorityOrder = { high: 3, medium: 2, low: 1 };
                return priorityOrder[b.priority] - priorityOrder[a.priority];
            });
            
            if (sortedTasks.length === 0) {
                tasksContainer.innerHTML = '<p style="text-align: center; color: var(--gray); padding: 2rem;">No tasks yet</p>';
            } else {
                sortedTasks.forEach(task => {
                    tasksContainer.appendChild(createTaskElement(task, true));
                });
            }
        }

        function renderBudgetManager() {
            const financials = calculateFinancials();
            
            // Update budget input
            document.getElementById('monthly-budget').value = appState.settings.monthlyBudget;
            
            // Update budget chart
            updateBudgetChart(financials.currentMonthExpense, Math.max(0, financials.budgetRemaining));
        }

        function renderInsights() {
            const financials = calculateFinancials();
            
            // Update spending chart
            updateSpendingChart(financials.categoryExpenses);
            
            // Clear AI insights
            document.getElementById('ai-insights').innerHTML = '';
        }

        function renderSettings() {
            // Settings are already populated by updateHeaderProfile()
        }

        // Helper functions for creating UI elements
        function createTransactionElement(transaction, withActions = false) {
            const div = document.createElement('div');
            div.className = `transaction-item transaction-${transaction.type}`;
            
            const typeIcon = transaction.type === 'income' ? 'arrow-down' : 'arrow-up';
            const typeClass = transaction.type === 'income' ? 'income' : 'expense';
            const amountSign = transaction.type === 'income' ? '+' : '-';
            
            div.innerHTML = `
                <div class="transaction-details">
                    <div class="transaction-icon ${typeClass}">
                        <i class="fas fa-${typeIcon}"></i>
                    </div>
                    <div class="transaction-info">
                        <h4>${transaction.note || 'No description'}</h4>
                        <p>${formatDate(transaction.date)} • ${transaction.category}</p>
                    </div>
                </div>
                <div class="transaction-amount ${typeClass}">
                    ${amountSign}₹${transaction.amount.toLocaleString()}
                </div>
            `;
            
            if (withActions) {
                const actions = document.createElement('div');
                actions.className = 'task-actions';
                actions.innerHTML = `
                    <button class="btn btn-outline" style="padding: 0.25rem 0.5rem; font-size: 0.8rem;">Edit</button>
                    <button class="btn btn-danger" style="padding: 0.25rem 0.5rem; font-size: 0.8rem;" data-id="${transaction.id}">Delete</button>
                `;
                
                // Add delete event listener
                const deleteBtn = actions.querySelector('.btn-danger');
                deleteBtn.addEventListener('click', function() {
                    const transactionId = parseInt(this.getAttribute('data-id'));
                    showConfirmation(
                        'Delete Transaction',
                        'Are you sure you want to delete this transaction?',
                        function() {
                            appState.transactions = appState.transactions.filter(t => t.id !== transactionId);
                            saveData();
                            renderApp();
                            alertMessage('Success', 'Transaction deleted successfully!', 'success');
                        }
                    );
                });
                
                div.appendChild(actions);
            }
            
            return div;
        }

        function createTaskElement(task, withActions = false) {
            const div = document.createElement('div');
            div.className = `task-item task-${task.priority}`;
            
            const priorityIcon = task.priority === 'high' ? 'exclamation-circle' : 
                               task.priority === 'medium' ? 'minus-circle' : 'info-circle';
            
            div.innerHTML = `
                <div class="task-details">
                    <div class="task-checkbox ${task.completed ? 'checked' : ''}" data-id="${task.id}">
                        ${task.completed ? '<i class="fas fa-check"></i>' : ''}
                    </div>
                    <div class="task-icon ${task.priority}">
                        <i class="fas fa-${priorityIcon}"></i>
                    </div>
                    <div class="task-info">
                        <h4 class="${task.completed ? 'task-completed' : ''}">${task.title}</h4>
                        <p>Due: ${formatDate(task.dueDate)}</p>
                    </div>
                </div>
            `;
            
            // Add event listener for task completion
            const checkbox = div.querySelector('.task-checkbox');
            checkbox.addEventListener('click', function() {
                const taskId = parseInt(this.getAttribute('data-id'));
                const taskIndex = appState.tasks.findIndex(t => t.id === taskId);
                
                if (taskIndex !== -1) {
                    appState.tasks[taskIndex].completed = !appState.tasks[taskIndex].completed;
                    saveData();
                    
                    const taskTitle = div.querySelector('h4');
                    this.classList.toggle('checked');
                    
                    if (this.classList.contains('checked')) {
                        this.innerHTML = '<i class="fas fa-check"></i>';
                        taskTitle.classList.add('task-completed');
                        taskTitle.classList.add('task-complete-animation');
                        
                        // Remove animation class after animation completes
                        setTimeout(() => {
                            taskTitle.classList.remove('task-complete-animation');
                        }, 500);
                    } else {
                        this.innerHTML = '';
                        taskTitle.classList.remove('task-completed');
                    }
                }
            });
            
            if (withActions) {
                const actions = document.createElement('div');
                actions.className = 'task-actions';
                actions.innerHTML = `
                    <button class="btn btn-outline" style="padding: 0.25rem 0.5rem; font-size: 0.8rem;">Edit</button>
                    <button class="btn btn-danger" style="padding: 0.25rem 0.5rem; font-size: 0.8rem;" data-id="${task.id}">Delete</button>
                `;
                
                // Add delete event listener
                const deleteBtn = actions.querySelector('.btn-danger');
                deleteBtn.addEventListener('click', function() {
                    const taskId = parseInt(this.getAttribute('data-id'));
                    showConfirmation(
                        'Delete Task',
                        'Are you sure you want to delete this task?',
                        function() {
                            appState.tasks = appState.tasks.filter(t => t.id !== taskId);
                            saveData();
                            renderApp();
                            alertMessage('Success', 'Task deleted successfully!', 'success');
                        }
                    );
                });
                
                div.appendChild(actions);
            }
            
            return div;
        }

        // Chart Functions
        function updateBudgetChart(spent, remaining) {
            const ctx = document.getElementById('budget-chart').getContext('2d');
            
            // Destroy existing chart if it exists
            if (window.budgetChart) {
                window.budgetChart.destroy();
            }
            
            window.budgetChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Spent', 'Remaining'],
                    datasets: [{
                        data: [spent, remaining],
                        backgroundColor: [
                            'rgba(247, 37, 133, 0.8)',
                            'rgba(67, 97, 238, 0.8)'
                        ],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    },
                    animation: {
                        animateScale: true,
                        animateRotate: true
                    }
                }
            });
        }

        function updateSpendingChart(categoryExpenses) {
            const ctx = document.getElementById('spending-chart').getContext('2d');
            
            // Destroy existing chart if it exists
            if (window.spendingChart) {
                window.spendingChart.destroy();
            }
            
            const categories = Object.keys(categoryExpenses);
            const amounts = Object.values(categoryExpenses);
            
            window.spendingChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: categories,
                    datasets: [{
                        label: 'Amount (₹)',
                        data: amounts,
                        backgroundColor: [
                            'rgba(67, 97, 238, 0.7)',
                            'rgba(76, 201, 240, 0.7)',
                            'rgba(247, 37, 133, 0.7)',
                            'rgba(248, 150, 30, 0.7)',
                            'rgba(106, 76, 235, 0.7)',
                            'rgba(72, 149, 239, 0.7)'
                        ],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    },
                    animation: {
                        duration: 1000,
                        easing: 'easeOutQuart'
                    }
                }
            });
        }

        // Utility Functions
        function formatDate(dateString) {
            const options = { day: 'numeric', month: 'short', year: 'numeric' };
            return new Date(dateString).toLocaleDateString('en-IN', options);
        }
    </script>
</body>
</html>
