<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DailyOS | Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap');

        :root {
            --primary: #4f46e5;
            --primary-hover: #4338ca;
            --secondary: #111827;
            --secondary-light: #1f2937;
            --text-main: #e5e7eb;
            --text-muted: #9ca3af;
            --border-color: #374151;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background-color: var(--secondary);
            color: var(--text-main);
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        /* --- Loading Screen --- */
        #loading-screen {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background-color: var(--secondary);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            transition: opacity 0.5s ease-out;
        }
        .spinner {
            width: 50px; height: 50px;
            border: 5px solid var(--border-color);
            border-top-color: var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        @keyframes spin { to { transform: rotate(360deg); } }

        /* --- Logout Modal --- */
        #logout-modal {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background-color: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(5px);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 50;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }
        #logout-modal.show { opacity: 1; pointer-events: auto; }
        .modal-content {
            background-color: var(--secondary-light);
            padding: 2rem;
            border-radius: 1rem;
            border: 1px solid var(--border-color);
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            text-align: center;
            transform: scale(0.95);
            transition: transform 0.3s ease;
        }
        #logout-modal.show .modal-content { transform: scale(1); }

        /* --- Animations --- */
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes slideInUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        
        .animate-fade-in { animation: fadeIn 0.5s ease-out forwards; }
        .animate-slide-in-up { animation: slideInUp 0.6s ease-out forwards; }

        /* --- Custom Scrollbar --- */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: var(--secondary); }
        ::-webkit-scrollbar-thumb { background-color: var(--border-color); border-radius: 10px; }
        ::-webkit-scrollbar-thumb:hover { background-color: #4b5563; }
        
        /* Sidebar Link Active State */
        .sidebar-link.active {
            background-color: var(--primary);
            color: white;
            box-shadow: 0 4px 15px -5px rgba(79, 70, 229, 0.7);
        }
    </style>
</head>
<body class="bg-secondary text-text-main">

    <!-- Loading Screen -->
    <div id="loading-screen">
        <div class="spinner"></div>
    </div>

    <!-- Logout Confirmation Modal -->
    <div id="logout-modal">
        <div class="modal-content space-y-6">
            <h2 class="text-2xl font-bold text-white">Confirm Logout</h2>
            <p class="text-text-muted">Are you sure you want to sign out?</p>
            <div class="flex justify-center gap-4">
                <button id="cancel-logout" class="px-6 py-2 rounded-lg bg-gray-600 hover:bg-gray-700 transition-colors">Cancel</button>
                <button id="confirm-logout" class="px-6 py-2 rounded-lg bg-red-600 hover:bg-red-700 transition-colors text-white">Logout</button>
            </div>
        </div>
    </div>

    <div id="app-container" class="flex h-screen opacity-0">
        <!-- Sidebar -->
        <nav id="sidebar" class="w-64 bg-secondary-light flex-shrink-0 p-4 border-r border-border-color transition-transform duration-300 ease-in-out -translate-x-full md:translate-x-0 md:relative">
            <div class="flex items-center gap-3 mb-10 px-2">
                 <img src="https://placehold.co/40x40/4f46e5/ffffff?text=D" alt="DailyOS Logo" class="rounded-lg">
                <h1 class="text-2xl font-bold text-white">DailyOS</h1>
            </div>
            <ul id="nav-links" class="space-y-2">
                <li><a href="#" class="sidebar-link active flex items-center gap-3 px-4 py-3 rounded-lg transition-colors hover:bg-primary hover:text-white" data-embed="https://gemini.google.com/faq"><i class="fas fa-home w-5 text-center"></i><span>Home</span></a></li>
                <li><a href="#" class="sidebar-link flex items-center gap-3 px-4 py-3 rounded-lg transition-colors hover:bg-primary hover:text-white" data-embed="goalstudy.html"><i class="fas fa-bullseye w-5 text-center"></i><span>Personal Goals</span></a></li>
                <li><a href="#" class="sidebar-link flex items-center gap-3 px-4 py-3 rounded-lg transition-colors hover:bg-primary hover:text-white" data-embed="goal.html"><i class="fas fa-list-check w-5 text-center"></i><span>To-Do List</span></a></li>
                <li><a href="#" class="sidebar-link flex items-center gap-3 px-4 py-3 rounded-lg transition-colors hover:bg-primary hover:text-white" data-embed="TA.html"><i class="fas fa-wallet w-5 text-center"></i><span>Transactions</span></a></li>
                <li><a href="#" class="sidebar-link flex items-center gap-3 px-4 py-3 rounded-lg transition-colors hover:bg-primary hover:text-white" data-embed="setting.html"><i class="fas fa-cog w-5 text-center"></i><span>Settings</span></a></li>
                <li><a href="#" class="sidebar-link flex items-center gap-3 px-4 py-3 rounded-lg transition-colors hover:bg-primary hover:text-white" data-embed="AboutUS.html"><i class="fas fa-info-circle w-5 text-center"></i><span>About Us</span></a></li>
            </ul>
        </nav>

        <!-- Main Content -->
        <main class="flex-1 flex flex-col">
            <!-- Header -->
            <header class="flex items-center justify-between p-4 border-b border-border-color bg-secondary-light flex-shrink-0">
                <button id="menu-toggle" class="md:hidden text-2xl"><i class="fas fa-bars"></i></button>
                <div class="text-lg">
                    <span>Welcome back, </span>
                    <span id="user-name" class="font-semibold text-white">User</span>
                </div>
                <button id="logout-button" class="flex items-center gap-2 px-4 py-2 rounded-lg text-sm bg-primary hover:bg-primary-hover transition-colors">
                    <i class="fas fa-sign-out-alt"></i>
                    <span class="hidden sm:inline">Logout</span>
                </button>
            </header>
            
            <!-- Embedded Content Area -->
            <section class="flex-1 p-4 overflow-y-auto">
                 <iframe id="content-frame" src="https://gemini.google.com/faq" class="w-full h-full border-0 rounded-lg bg-secondary-light"></iframe>
            </section>
        </main>
    </div>

<script type="module">
// --- Firebase SDKs ---
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-app.js";
import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-auth.js";

// --- Firebase Configuration ---
const firebaseConfig = {
            apiKey: "AIzaSyCS06RYItsN_lYq0ZI-Yfv2WRzyuac28EY",
            authDomain: "dailyos-f2eb6.firebaseapp.com",
            projectId: "dailyos-f2eb6",
            storageBucket: "dailyos-f2eb6.firebasestorage.app",
            messagingSenderId: "173476838340",
            appId: "1:173476838340:web:a0811c7c42615cf27f4291",
            measurementId: "G-QDM68MDX6S"
};

// --- Initialize Firebase ---
const app = initializeApp(firebaseConfig);
const auth = getAuth(app);

// --- DOM Elements ---
const loadingScreen = document.getElementById('loading-screen');
const appContainer = document.getElementById('app-container');
const userNameEl = document.getElementById('user-name');
const logoutButton = document.getElementById('logout-button');
const logoutModal = document.getElementById('logout-modal');
const confirmLogout = document.getElementById('confirm-logout');
const cancelLogout = document.getElementById('cancel-logout');
const contentFrame = document.getElementById('content-frame');
const navLinks = document.querySelectorAll('.sidebar-link');
const menuToggle = document.getElementById('menu-toggle');
const sidebar = document.getElementById('sidebar');

// --- Auth Guard (Core Security) ---
onAuthStateChanged(auth, user => {
    if (user) {
        // User is logged in
        userNameEl.textContent = user.displayName || user.email;
        
        // Hide loading screen and show app with animation
        loadingScreen.style.opacity = '0';
        setTimeout(() => {
            loadingScreen.style.display = 'none';
            appContainer.style.opacity = '1';
            appContainer.classList.add('animate-fade-in');
            document.querySelectorAll('#sidebar, header, #content-frame').forEach((el, index) => {
                el.style.animationDelay = `${index * 100}ms`;
                el.classList.add('animate-slide-in-up');
            });
        }, 500);

    } else {
        // User is not logged in, redirect to login page
        window.location.href = 'login.html';
    }
});

// --- Navigation Logic ---
navLinks.forEach(link => {
    link.addEventListener('click', e => {
        e.preventDefault();
        
        // Update active class
        navLinks.forEach(l => l.classList.remove('active'));
        link.classList.add('active');
        
        // Load content into iframe
        const embedUrl = link.getAttribute('data-embed');
        if (embedUrl) {
            contentFrame.src = embedUrl;
        }

        // Close sidebar on mobile after click
        if (window.innerWidth < 768) {
            sidebar.classList.add('-translate-x-full');
        }
    });
});

// --- Logout Logic ---
logoutButton.addEventListener('click', () => {
    logoutModal.classList.add('show');
});

cancelLogout.addEventListener('click', () => {
    logoutModal.classList.remove('show');
});

confirmLogout.addEventListener('click', () => {
    signOut(auth).catch(error => {
        console.error('Sign out error', error);
        // The onAuthStateChanged listener will redirect anyway
    });
});

// --- Mobile Menu Toggle ---
menuToggle.addEventListener('click', () => {
    sidebar.classList.toggle('-translate-x-full');
});
</script>
</body>
</html>

